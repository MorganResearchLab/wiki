"use strict";(self.webpackChunkmorganlab_wiki=self.webpackChunkmorganlab_wiki||[]).push([[571],{7761:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var r=t(4848),i=t(8453);const o={title:"Running a Jupyter Server",label:"Running a Jupyter Server",sidebar_position:5},s="Running a Jupyter Server",a={id:"working-with-hpc/running-a-jupyter-server",title:"Running a Jupyter Server",description:"Introduction",source:"@site/docs/working-with-hpc/running-a-jupyter-server.md",sourceDirName:"working-with-hpc",slug:"/working-with-hpc/running-a-jupyter-server",permalink:"/wiki/working-with-hpc/running-a-jupyter-server",draft:!1,unlisted:!1,editUrl:"https://github.com/MorganResearchLab/wiki/docs/working-with-hpc/running-a-jupyter-server.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Running a Jupyter Server",label:"Running a Jupyter Server",sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Managing packages",permalink:"/wiki/working-with-hpc/managing-packages"},next:{title:"Frequently asked questions",permalink:"/wiki/working-with-hpc/frequenty-asked-questions"}},l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Creating Jupyter server",id:"creating-jupyter-server",level:2},{value:"More resources",id:"more-resources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"running-a-jupyter-server",children:"Running a Jupyter Server"}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"Jupyter notebook is very handy for fast-prototyping or quick Python code testing. In this guide, we will be using VS Code to create a Jupyter Server and run Jupyter notebook on Maxwell. Before starting please make sure you have installed the following:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://code.visualstudio.com/download",children:"Visual Studio Code"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter",children:"VS Code Jupyter extension"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Every file with ",(0,r.jsx)(n.code,{children:".ipynb"})," extension will be detected as a Jupyter notebook file, you can create a file and put a ",(0,r.jsx)(n.code,{children:".ipynb"})," extension and it will become a Jupyter notebook\n",(0,r.jsx)(n.img,{alt:"New Jupyter notebook file",src:t(9095).A+"",width:"1231",height:"321"})]}),"\n",(0,r.jsxs)(n.p,{children:["To start working with Jupyter notebook you will need to select a kernel ",(0,r.jsx)(n.img,{alt:"Kernel selection",src:t(620).A+"",width:"1237",height:"397"})]}),"\n",(0,r.jsx)(n.p,{children:"There are two options, you can use the readily available environments (Maxwell default conda environments, your conda environments or your pip environments if you're in the same directory with it). The problem with selecting this option is the fact that you will be using login node which is very slow and may fail because of you don't have enough memory to run your script. Most of the time we will opt for the second choice, to use the Existing Jupyter server."}),"\n",(0,r.jsx)(n.h2,{id:"creating-jupyter-server",children:"Creating Jupyter server"}),"\n",(0,r.jsx)(n.p,{children:"To create a Jupyter server we need to submit a slurm job that handles the running of Jupyter server in the background for us"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="start_jupyter.sh"',children:"#!/bin/bash\n#SBATCH --time=01:00:00\n#SBATCH --cpus-per-task=8\n#SBATCH --ntasks=1\n#SBATCH --mem=64G\n#SBATCH --job-name=jupyter-notebook\n#SBATCH --output=jupyter-notebook.log\n\nmodule load mamba\nsource ~/.bash_profile\nsource ~/.bashrc\n\nmamba activate my_environment\njupyter notebook --no-browser --ip=0.0.0.0\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Change ",(0,r.jsx)(n.code,{children:"#SBATCH"})," options according to your need, in my case I need 64 GB memory, with 8 CPUs per task and keep it running for the next 1 hour. If you're not sure with the ",(0,r.jsx)(n.code,{children:"#SBATCH"})," option or you want to add more option, you can refer to ",(0,r.jsx)(n.a,{href:"https://slurm.schedmd.com/sbatch.html",children:"this"}),". The next lines I'm loading ",(0,r.jsx)(n.code,{children:"mamba"}),", my ",(0,r.jsx)(n.code,{children:"bash_profile"})," and setup (The reason was if I remember it correctly because if I don't do it it will use the default ",(0,r.jsx)(n.code,{children:"base"})," environment that may cause clash with the package dependencies installed in my environment, so yes it's better to include them). The lines that follow is to activate my environment (",(0,r.jsx)(n.strong,{children:"NOTE"}),": You must have ",(0,r.jsx)(n.code,{children:"ipykernel"})," package installed in your environment otherwise the server creation will fail) and to create a Jupyter notebook server."]}),"\n",(0,r.jsxs)(n.p,{children:["Once you submit the job, the log will appear (in my case ",(0,r.jsx)(n.code,{children:"jupyter-notebook.log"}),") wait for around 2 or 3 minutes till the log file is filled with Jupyter logs (Either server is fully running or it's failed). Open the ",(0,r.jsx)(n.code,{children:"jupyter-notebook.log"}),", if it's successful you will see the url to the server."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Jupyter notebook log",src:t(7157).A+"",width:"829",height:"691"})}),"\n",(0,r.jsxs)(n.p,{children:["Copy the url, the one that doesn't start with the ",(0,r.jsx)(n.code,{children:"http://127.0.0.1......"})," (in my case it's ",(0,r.jsx)(n.code,{children:"http://vhmem002.int.maxwell.abdn.ac.uk:8888/tree?token=fac698f887a93963b6b7f860158e2e83ce5f03b4281978e6"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["Go back to your Jupyter notebook, click ",(0,r.jsx)(n.code,{children:"Select Kernel"})," and select ",(0,r.jsx)(n.code,{children:"Existing Jupyter Server..."}),", paste the url, press enter and when prompted with environment selection, select your environment (There is only one of it)."]}),"\n",(0,r.jsx)(n.h2,{id:"more-resources",children:"More resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://code.visualstudio.com/docs/datascience/jupyter-notebooks",children:"Visual Studio Code's Jupyter Notebooks in VS Code"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},9095:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/03_01-82e423e6bddae9828a355bad9310ac54.png"},620:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/03_02-b09c7f7edd42ed2caa07d50b41cfd371.png"},7157:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/03_03-ea8743d4c5d6b4ab51e70d3dc5d56d20.png"},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var r=t(6540);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);